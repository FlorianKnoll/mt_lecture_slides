\tikzsetnextfilename{mr_t2_preparation_spins_1}
\begin{tikzpicture}[scale = 1.8,
                    >=stealth']

	\draw (0, -0.3) ellipse (10ex and 3.5ex);
	\fill[white] (-10ex, 0) -- (10ex, 0) -- (10ex, -0.3) -- (-10ex, -0.3) -- cycle;
	\draw (-10ex, 0) -- (-10ex, -0.3);
	\draw ( 10ex, 0) -- ( 10ex, -0.3);
	\draw[fill=white] (0, 0) ellipse (10ex and 3.5ex);
	
	\tikzset{
    partial ellipse/.style args={#1:#2:#3}{
        insert path={+ (#1:#3) arc (#1:#2:#3)}
    }
	}
	
	\draw[red, thick, ->] (0, -0.4) [partial ellipse=200:340:10ex and 3.5ex];
	
	% Stick figure
	\begin{scope}[xshift=5ex, yshift=2ex]
		\draw (-12ex, 0.5) circle (0.1);
		\draw (-12ex, 0.4) -- (-12ex, 0);
		\draw (-12ex, 0.3) -- ++(0.1, -0.1);
		\draw (-12ex, 0.3) -- ++(-0.1, -0.1);
		\draw (-12ex, 0) -- ++(0.1, -0.3);
		\draw (-12ex, 0) -- ++(-0.1, -0.3);
	\end{scope}
	
	\begin{scope}[x  = {(-0.5cm,-0.5cm)},
                    y  = {(0.9659cm,-0.25882cm)},
                    z  = {(0cm,1cm)}]
	
	\draw[ultra thick,->] (-1,1,0.3) -- (-1,1,0.9) node [above] {\B0};
	\draw[ultra thick,->] (-1,1,0.3) -- (-0.5,1,0.3) node [below] {\B1};
	
	\draw[very thick,->] (0, 0, 0) -- (0, 0, 1) node [above=1.5ex] {\magn{} before excitation};
	\draw[very thick,dotted,->] (0, 0, 0) -- (1, 0, 0) node [right=1.3ex, inner sep=2pt, rounded corners, fill=white] {\magn{} after excitation};
	
	\draw[blue, very thick, densely dotted] ( 0.0000,  0.0000,  1.0000)
 -- ( 0.0087,  0.0000,  1.0000)
 -- ( 0.0175,  0.0000,  0.9998)
 -- ( 0.0262,  0.0000,  0.9997)
 -- ( 0.0349,  0.0000,  0.9994)
 -- ( 0.0436,  0.0000,  0.9990)
 -- ( 0.0523,  0.0000,  0.9986)
 -- ( 0.0610,  0.0000,  0.9981)
 -- ( 0.0698,  0.0000,  0.9976)
 -- ( 0.0785,  0.0000,  0.9969)
 -- ( 0.0872,  0.0000,  0.9962)
 -- ( 0.0958,  0.0000,  0.9954)
 -- ( 0.1045,  0.0000,  0.9945)
 -- ( 0.1132,  0.0000,  0.9936)
 -- ( 0.1219,  0.0000,  0.9925)
 -- ( 0.1305,  0.0000,  0.9914)
 -- ( 0.1392,  0.0000,  0.9903)
 -- ( 0.1478,  0.0000,  0.9890)
 -- ( 0.1564,  0.0000,  0.9877)
 -- ( 0.1650,  0.0000,  0.9863)
 -- ( 0.1736,  0.0000,  0.9848)
 -- ( 0.1822,  0.0000,  0.9833)
 -- ( 0.1908,  0.0000,  0.9816)
 -- ( 0.1994,  0.0000,  0.9799)
 -- ( 0.2079,  0.0000,  0.9781)
 -- ( 0.2164,  0.0000,  0.9763)
 -- ( 0.2250,  0.0000,  0.9744)
 -- ( 0.2334,  0.0000,  0.9724)
 -- ( 0.2419,  0.0000,  0.9703)
 -- ( 0.2504,  0.0000,  0.9681)
 -- ( 0.2588,  0.0000,  0.9659)
 -- ( 0.2672,  0.0000,  0.9636)
 -- ( 0.2756,  0.0000,  0.9613)
 -- ( 0.2840,  0.0000,  0.9588)
 -- ( 0.2924,  0.0000,  0.9563)
 -- ( 0.3007,  0.0000,  0.9537)
 -- ( 0.3090,  0.0000,  0.9511)
 -- ( 0.3173,  0.0000,  0.9483)
 -- ( 0.3256,  0.0000,  0.9455)
 -- ( 0.3338,  0.0000,  0.9426)
 -- ( 0.3420,  0.0000,  0.9397)
 -- ( 0.3502,  0.0000,  0.9367)
 -- ( 0.3584,  0.0000,  0.9336)
 -- ( 0.3665,  0.0000,  0.9304)
 -- ( 0.3746,  0.0000,  0.9272)
 -- ( 0.3827,  0.0000,  0.9239)
 -- ( 0.3907,  0.0000,  0.9205)
 -- ( 0.3987,  0.0000,  0.9171)
 -- ( 0.4067,  0.0000,  0.9135)
 -- ( 0.4147,  0.0000,  0.9100)
 -- ( 0.4226,  0.0000,  0.9063)
 -- ( 0.4305,  0.0000,  0.9026)
 -- ( 0.4384,  0.0000,  0.8988)
 -- ( 0.4462,  0.0000,  0.8949)
 -- ( 0.4540,  0.0000,  0.8910)
 -- ( 0.4617,  0.0000,  0.8870)
 -- ( 0.4695,  0.0000,  0.8829)
 -- ( 0.4772,  0.0000,  0.8788)
 -- ( 0.4848,  0.0000,  0.8746)
 -- ( 0.4924,  0.0000,  0.8704)
 -- ( 0.5000,  0.0000,  0.8660)
 -- ( 0.5075,  0.0000,  0.8616)
 -- ( 0.5150,  0.0000,  0.8572)
 -- ( 0.5225,  0.0000,  0.8526)
 -- ( 0.5299,  0.0000,  0.8480)
 -- ( 0.5373,  0.0000,  0.8434)
 -- ( 0.5446,  0.0000,  0.8387)
 -- ( 0.5519,  0.0000,  0.8339)
 -- ( 0.5592,  0.0000,  0.8290)
 -- ( 0.5664,  0.0000,  0.8241)
 -- ( 0.5736,  0.0000,  0.8192)
 -- ( 0.5807,  0.0000,  0.8141)
 -- ( 0.5878,  0.0000,  0.8090)
 -- ( 0.5948,  0.0000,  0.8039)
 -- ( 0.6018,  0.0000,  0.7986)
 -- ( 0.6088,  0.0000,  0.7934)
 -- ( 0.6157,  0.0000,  0.7880)
 -- ( 0.6225,  0.0000,  0.7826)
 -- ( 0.6293,  0.0000,  0.7771)
 -- ( 0.6361,  0.0000,  0.7716)
 -- ( 0.6428,  0.0000,  0.7660)
 -- ( 0.6494,  0.0000,  0.7604)
 -- ( 0.6561,  0.0000,  0.7547)
 -- ( 0.6626,  0.0000,  0.7490)
 -- ( 0.6691,  0.0000,  0.7431)
 -- ( 0.6756,  0.0000,  0.7373)
 -- ( 0.6820,  0.0000,  0.7314)
 -- ( 0.6884,  0.0000,  0.7254)
 -- ( 0.6947,  0.0000,  0.7193)
 -- ( 0.7009,  0.0000,  0.7133)
 -- ( 0.7071,  0.0000,  0.7071)
 -- ( 0.7133,  0.0000,  0.7009)
 -- ( 0.7193,  0.0000,  0.6947)
 -- ( 0.7254,  0.0000,  0.6884)
 -- ( 0.7314,  0.0000,  0.6820)
 -- ( 0.7373,  0.0000,  0.6756)
 -- ( 0.7431,  0.0000,  0.6691)
 -- ( 0.7490,  0.0000,  0.6626)
 -- ( 0.7547,  0.0000,  0.6561)
 -- ( 0.7604,  0.0000,  0.6494)
 -- ( 0.7660,  0.0000,  0.6428)
 -- ( 0.7716,  0.0000,  0.6361)
 -- ( 0.7771,  0.0000,  0.6293)
 -- ( 0.7826,  0.0000,  0.6225)
 -- ( 0.7880,  0.0000,  0.6157)
 -- ( 0.7934,  0.0000,  0.6088)
 -- ( 0.7986,  0.0000,  0.6018)
 -- ( 0.8039,  0.0000,  0.5948)
 -- ( 0.8090,  0.0000,  0.5878)
 -- ( 0.8141,  0.0000,  0.5807)
 -- ( 0.8192,  0.0000,  0.5736)
 -- ( 0.8241,  0.0000,  0.5664)
 -- ( 0.8290,  0.0000,  0.5592)
 -- ( 0.8339,  0.0000,  0.5519)
 -- ( 0.8387,  0.0000,  0.5446)
 -- ( 0.8434,  0.0000,  0.5373)
 -- ( 0.8480,  0.0000,  0.5299)
 -- ( 0.8526,  0.0000,  0.5225)
 -- ( 0.8572,  0.0000,  0.5150)
 -- ( 0.8616,  0.0000,  0.5075)
 -- ( 0.8660,  0.0000,  0.5000)
 -- ( 0.8704,  0.0000,  0.4924)
 -- ( 0.8746,  0.0000,  0.4848)
 -- ( 0.8788,  0.0000,  0.4772)
 -- ( 0.8829,  0.0000,  0.4695)
 -- ( 0.8870,  0.0000,  0.4617)
 -- ( 0.8910,  0.0000,  0.4540)
 -- ( 0.8949,  0.0000,  0.4462)
 -- ( 0.8988,  0.0000,  0.4384)
 -- ( 0.9026,  0.0000,  0.4305)
 -- ( 0.9063,  0.0000,  0.4226)
 -- ( 0.9100,  0.0000,  0.4147)
 -- ( 0.9135,  0.0000,  0.4067)
 -- ( 0.9171,  0.0000,  0.3987)
 -- ( 0.9205,  0.0000,  0.3907)
 -- ( 0.9239,  0.0000,  0.3827)
 -- ( 0.9272,  0.0000,  0.3746)
 -- ( 0.9304,  0.0000,  0.3665)
 -- ( 0.9336,  0.0000,  0.3584)
 -- ( 0.9367,  0.0000,  0.3502)
 -- ( 0.9397,  0.0000,  0.3420)
 -- ( 0.9426,  0.0000,  0.3338)
 -- ( 0.9455,  0.0000,  0.3256)
 -- ( 0.9483,  0.0000,  0.3173)
 -- ( 0.9511,  0.0000,  0.3090)
 -- ( 0.9537,  0.0000,  0.3007)
 -- ( 0.9563,  0.0000,  0.2924)
 -- ( 0.9588,  0.0000,  0.2840)
 -- ( 0.9613,  0.0000,  0.2756)
 -- ( 0.9636,  0.0000,  0.2672)
 -- ( 0.9659,  0.0000,  0.2588)
 -- ( 0.9681,  0.0000,  0.2504)
 -- ( 0.9703,  0.0000,  0.2419)
 -- ( 0.9724,  0.0000,  0.2334)
 -- ( 0.9744,  0.0000,  0.2250)
 -- ( 0.9763,  0.0000,  0.2164)
 -- ( 0.9781,  0.0000,  0.2079)
 -- ( 0.9799,  0.0000,  0.1994)
 -- ( 0.9816,  0.0000,  0.1908)
 -- ( 0.9833,  0.0000,  0.1822)
 -- ( 0.9848,  0.0000,  0.1736)
 -- ( 0.9863,  0.0000,  0.1650)
 -- ( 0.9877,  0.0000,  0.1564)
 -- ( 0.9890,  0.0000,  0.1478)
 -- ( 0.9903,  0.0000,  0.1392)
 -- ( 0.9914,  0.0000,  0.1305)
 -- ( 0.9925,  0.0000,  0.1219)
 -- ( 0.9936,  0.0000,  0.1132)
 -- ( 0.9945,  0.0000,  0.1045)
 -- ( 0.9954,  0.0000,  0.0958)
 -- ( 0.9962,  0.0000,  0.0872)
 -- ( 0.9969,  0.0000,  0.0785)
 -- ( 0.9976,  0.0000,  0.0698)
 -- ( 0.9981,  0.0000,  0.0610)
 -- ( 0.9986,  0.0000,  0.0523)
 -- ( 0.9990,  0.0000,  0.0436)
 -- ( 0.9994,  0.0000,  0.0349)
 -- ( 0.9997,  0.0000,  0.0262)
 -- ( 0.9998,  0.0000,  0.0175)
 -- ( 1.0000,  0.0000,  0.0087)
 -- ( 1.0000,  0.0000,  0.0000);
	
	\end{scope}

	%\draw[->] (0,-0.3,0) -- (0,1,0) node [right] {$y$};
	%\draw[->] (-0.3,0,0) -- (1,0,0) node [below left] {$x$};

	%\draw[->,ultra thick,lightgray] (0,0,0) -- (0,0,0.8);
	%\draw[->,ultra thick,densely dashed,lightgray] (0.2,0,0) -- (0.2,0,0.8);
	%\draw[->,ultra thick,densely dotted,lightgray] (-0.2,0,0) -- (-0.2,0,0.8);

	%\draw[->,ultra thick] (0,0,0) -- (0,0.8,0);
	%\draw[->,ultra thick,densely dashed] (0.2,0,0) -- (0.2,0.8,0);
	%\draw[->,ultra thick,densely dotted] (-0.2,0,0) -- (-0.2,0.8,0);

	%\draw[->, overlay] (-0.2, 0, 0.3) to[out=0,in=80] node [right] {$90^\circ$ pulse} (-0.2, 0.3, 0);

	%\draw[overlay] (-0.2, 0, 0.6) -- +(-0.5, 0.4, 0.2) node [right,font=\footnotesize] {venous blood};
	%\draw[overlay] (0, 0, 0.6)    -- +(-0.5, 0.4, 0.1) node [right,font=\footnotesize] {arterial blood};
	%\draw[overlay] (0.2, 0, 0.6)  -- +(-0.5, 0.4, 0) node [right,font=\footnotesize] {myocardium};

\end{tikzpicture}